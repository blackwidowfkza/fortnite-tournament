<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>FKZA Duo Cash Cup</title>
  <meta content="#1f6feb" name="theme-color"/>
  <meta content="FKZA Duo Cash Cup" property="og:title"/>
  <meta content="Join the FKZA Duo Zero Build Cup - Register, Verify and Compete!" property="og:description"/>
  <meta content="https://i.ibb.co/FbL2kmSn/Untitled-design-1.png" property="og:image"/>
  <meta content="summary_large_image" name="twitter:card"/>
  <link rel="icon" href="https://i.ibb.co/FbL2kmSn/Untitled-design-1.png" type="image/png">
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #0d1117;
      color: #f0f6fc;
    }
    header {
      text-align: center;
      padding: 2rem 1rem 1rem 1rem;
    }
    header img {
      max-height: 160px;
      border-radius: 12px;
      margin-bottom: 0.5rem;
    }
    header h1 {
      font-size: 2.8rem;
      margin: 0.5rem 0;
    }
    #countdown {
      font-size: 1.5rem;
      color: #f9c846;
      margin-top: 0.5rem;
    }
    section {
      max-width: 800px;
      margin: 2rem auto;
      padding: 0 1rem;
    }
    h2 {
      border-bottom: 2px solid #30363d;
      padding-bottom: 0.5rem;
      color: #58a6ff;
    }
    ul {
      line-height: 1.8;
      padding-left: 1rem;
    }
    .button {
      background: #238636;
      color: white;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: bold;
      transition: background 0.2s;
    }
    .button:hover {
      background: #2ea043;
    }
    .button:disabled {
      background: #484f58;
      cursor: not-allowed;
    }
    input {
      width: 100%;
      padding: 0.75rem;
      margin-bottom: 1rem;
      border-radius: 6px;
      border: 1px solid #30363d;
      background: #0d1117;
      color: #f0f6fc;
      font-size: 1rem;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: #161b22;
      color: #f0f6fc;
      margin-bottom: 1rem;
      border-radius: 6px;
      overflow: hidden;
    }
    th, td {
      text-align: left;
      padding: 12px 15px;
      border-bottom: 1px solid #30363d;
    }
    footer {
      text-align: center;
      padding: 2rem;
      background: #161b22;
      color: #8b949e;
      margin-top: 2rem;
    }
    .collapsible-toggle {
      cursor: pointer;
      color: #58a6ff;
      margin: 0;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .collapsible-content {
      display: block;
      overflow: hidden;
    }
    .collapsed + .collapsible-content {
      display: none;
    }
    .registered-duos {
      background: #161b22;
      border-radius: 8px;
      padding: 1rem;
      margin-top: 1rem;
    }
    .registered-duos li {
      padding: 0.75rem 0;
      border-bottom: 1px solid #30363d;
      display: flex;
      justify-content: space-between;
    }
    .max-registered {
      color: #f85149;
      font-weight: bold;
      text-align: center;
      padding: 1.5rem;
      background: #161b22;
      border-radius: 8px;
      border: 1px solid #f85149;
    }
    .spots-remaining {
      color: #f9c846;
      font-weight: bold;
      margin-top: 1rem;
      text-align: center;
      font-size: 1.1rem;
    }
    #submitStatus {
      margin-top: 1rem;
      padding: 0.75rem;
      border-radius: 6px;
      text-align: center;
    }
    .loading {
      color: #8b949e;
      text-align: center;
      padding: 1rem;
    }
    .team-number {
      color: #f9c846;
      margin-right: 10px;
    }
  </style>
</head>
<body>
<header>
  <img alt="FKZA Logo" src="https://i.ibb.co/FbL2kmSn/Untitled-design-1.png"/>
  <h1>FKZA Duo Cash Cup</h1>
  <div id="countdown">Loading...</div>
</header>

<section>
  <h2 class="collapsible-toggle">üìÖ Tournament</h2>
  <div class="collapsible-content">
    <ul>
      <li><strong>Date &amp; Time:</strong> 31st May 2025, 7PM SAST</li>
      <li><strong>Format:</strong> Duos</li>
      <li><strong>Game Mode:</strong> Reload Zero Builds</li>
      <li><strong>Server:</strong> EU</li>
    </ul>
  </div>
</section>

<section>
  <h2 class="collapsible-toggle">üì• How to Register</h2>
  <div class="collapsible-content">
    <ul>
      <li>1. Follow <a href="https://www.tiktok.com/@fort_knights_za?lang=en" target="_blank">FKZA on TikTok</a></li>
      <li>2. Join our <a href="https://discord.gg/PC5ArHu6" target="_blank">Discord server</a></li>
      <li>3. Register using the form below</li>
    </ul>
  </div>
</section>

<section>
  <h2 class="collapsible-toggle">üìù Register Your Duo</h2>
  <div class="collapsible-content" id="registrationSection">
    <form id="duoForm">
      <label>Your Discord Name (without #numbers):</label>
      <input id="player" placeholder="e.g. Sypher" required type="text"/>
      
      <label>Duo Partner's Discord Name (without #numbers):</label>
      <input id="duo" placeholder="e.g. Ninja" required type="text"/>
      
      <button class="button" type="submit" id="submitButton">Submit Registration</button>
    </form>
    <div id="submitStatus"></div>
  </div>
</section>

<section>
  <h2 class="collapsible-toggle">üèÜ Registered Duos</h2>
  <div class="collapsible-content">
    <div class="registered-duos">
      <ul id="registeredDuosList">
        <li class="loading">Loading registered duos...</li>
      </ul>
      <p id="spotsRemaining" class="spots-remaining">Loading spots...</p>
    </div>
  </div>
</section>

<section>
  <h2 class="collapsible-toggle">üí∞ Prizepool</h2>
  <div class="collapsible-content">
    <table>
      <thead>
        <tr><th>Placement</th><th>Prize</th></tr>
      </thead>
      <tbody>
        <tr><td>1st Place</td><td>R800</td></tr>
        <tr><td>2nd Place</td><td>R500</td></tr>
        <tr><td>3rd Place</td><td>R300</td></tr>
        <tr><td>4th Place</td><td>2000 V-Bucks</td></tr>
      </tbody>
    </table>
  </div>
</section>

<section>
  <h2 class="collapsible-toggle">üéØ Scoring</h2>
  <div class="collapsible-content">
    <h3>Placement Points</h3>
    <table>
      <thead>
        <tr><th>Placement</th><th>Points</th></tr>
      </thead>
      <tbody>
        <tr><td>1st</td><td>20</td></tr>
        <tr><td>2nd</td><td>17</td></tr>
        <tr><td>3rd</td><td>15</td></tr>
        <tr><td>4th</td><td>13</td></tr>
        <tr><td>5th</td><td>11</td></tr>
        <tr><td>6th</td><td>9</td></tr>
        <tr><td>7th</td><td>7</td></tr>
        <tr><td>8th</td><td>5</td></tr>
        <tr><td>9th-10th</td><td>3</td></tr>
        <tr><td>11th-15th</td><td>1</td></tr>
        <tr><td>16th-20th</td><td>0</td></tr>
      </tbody>
    </table>
    <p><strong>Eliminations:</strong> 1 point per elimination</p>
  </div>
</section>

<section>
  <h2 class="collapsible-toggle">üö´ Rules</h2>
  <div class="collapsible-content">
    <ul>
      <li><strong>No teaming</strong> with other duos</li>
      <li><strong>No building</strong> exploits in Zero Build mode</li>
      <li><strong>No cheating</strong> or third-party software</li>
      <li><strong>Be respectful</strong> in voice and text chat</li>
      <li>Must use <strong>your own account</strong></li>
    </ul>
  </div>
</section>

<footer>
  FKZA Customs ¬© 2025 ‚Äì Powered by Yunite | Hosted on GitHub Pages
</footer>

<script>
  // REPLACE THIS WITH YOUR GOOGLE APPS SCRIPT URL
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyoeD13nW_bBU_uuOuXhZQ-JZEbu4b0KX8SWi7h4Bzrj0zx-dZTY6lfSPpxe-NEY5Ak/exec";
  
  // DOM elements
  const duoForm = document.getElementById("duoForm");
  const submitButton = document.getElementById("submitButton");
  const submitStatus = document.getElementById("submitStatus");
  const registeredDuosList = document.getElementById("registeredDuosList");
  const spotsRemaining = document.getElementById("spotsRemaining");
  const registrationSection = document.getElementById("registrationSection");
  
  // Countdown timer
  const eventDate = new Date("2025-05-31T17:00:00+02:00"); // SAST timezone
  function updateCountdown() {
    const now = new Date();
    const diff = eventDate - now;
    const el = document.getElementById("countdown");

    if (diff <= 0) {
      el.textContent = "The tournament is live!";
      return;
    }

    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
    const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
    const minutes = Math.floor((diff / (1000 * 60)) % 60);
    const seconds = Math.floor((diff / 1000) % 60);

    el.textContent = `${days}d ${hours}h ${minutes}m ${seconds}s`;
  }

  // Load registrations on page load
  document.addEventListener('DOMContentLoaded', () => {
    updateCountdown();
    setInterval(updateCountdown, 1000);
    fetchRegistrations();
    
    // Setup collapsible sections
    document.querySelectorAll('.collapsible-toggle').forEach(h2 => {
      h2.addEventListener('click', () => {
        h2.classList.toggle('collapsed');
        const content = h2.nextElementSibling;
        content.style.display = content.style.display === 'none' ? 'block' : 'none';
      });
    });
  });

  // Fetch current registrations
  async function fetchRegistrations() {
    try {
      registeredDuosList.innerHTML = '<li class="loading">Loading registered duos...</li>';
      
      const response = await fetch(`${SCRIPT_URL}?action=get`);
      const { registrations } = await response.json();
      
      updateRegisteredDuosList(registrations);
      updateSpotsRemaining(registrations.length);
      checkMaxRegistrations(registrations.length);
    } catch (error) {
      console.error("Failed to load registrations:", error);
      registeredDuosList.innerHTML = '<li class="loading">Error loading registrations. Please refresh.</li>';
    }
  }

  // Handle form submission
  duoForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    
    const player = document.getElementById("player").value.trim();
    const duo = document.getElementById("duo").value.trim();

    if (!player || !duo) {
      showStatus("‚ùå Please fill in both names", "red");
      return;
    }

    submitButton.disabled = true;
    showStatus("Submitting registration...", "#8b949e");

    try {
      const response = await fetch(SCRIPT_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ player, duo })
      });
      
      const result = await response.json();
      
      if (result.success) {
        showStatus("‚úÖ Registration submitted successfully!", "lightgreen");
        document.getElementById("duoForm").reset();
        fetchRegistrations(); // Refresh the list
      } else {
        showStatus("‚ùå Registration failed. Please try again.", "red");
      }
    } catch (error) {
      console.error("Registration error:", error);
      showStatus("‚ùå Network error. Please check your connection.", "red");
    } finally {
      submitButton.disabled = false;
    }
  });

  // Update the registered duos list
  function updateRegisteredDuosList(registrations) {
    if (registrations.length === 0) {
      registeredDuosList.innerHTML = '<li>No duos registered yet</li>';
      return;
    }
    
    registeredDuosList.innerHTML = registrations
      .slice(0, 20) // Only show first 20
      .map((team, index) => `
        <li>
          <span class="team-number">Team ${index + 1}:</span>
          <span>${team.player} & ${team.duo}</span>
        </li>
      `).join('');
  }

  // Update spots remaining counter
  function updateSpotsRemaining(count) {
    const remaining = 20 - count;
    spotsRemaining.innerHTML = `
      Spots remaining: <strong>${remaining > 0 ? remaining : 0}</strong>/20
      ${remaining <= 0 ? ' (Tournament full!)' : ''}
    `;
  }

  // Check if max registrations reached
  function checkMaxRegistrations(count) {
    if (count >= 20) {
      registrationSection.innerHTML = `
        <div class="max-registered">
          <p>üö® Tournament registrations are now closed!</p>
          <p>Maximum of 20 duos has been reached.</p>
        </div>
      `;
    }
  }

  // Show status messages
  function showStatus(message, color) {
    submitStatus.textContent = message;
    submitStatus.style.color = color;
    submitStatus.style.backgroundColor = color === "lightgreen" ? "rgba(35, 134, 54, 0.1)" : 
                                        color === "red" ? "rgba(248, 81, 73, 0.1)" : 
                                        "rgba(139, 148, 158, 0.1)";
  }
</script>
</body>
</html>
